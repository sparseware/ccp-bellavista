//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: com/sparseware/bellavista/TrendPanel.java
//
//  Created by decoteaud on 3/12/15.
//

#include "IOSClass.h"
#include "IOSFloatArray.h"
#include "IOSObjectArray.h"
#include "com/appnativa/rare/Platform.h"
#include "com/appnativa/rare/spot/Label.h"
#include "com/appnativa/rare/ui/ColorUtils.h"
#include "com/appnativa/rare/ui/Column.h"
#include "com/appnativa/rare/ui/FontUtils.h"
#include "com/appnativa/rare/ui/RenderableDataItem.h"
#include "com/appnativa/rare/ui/ScreenUtils.h"
#include "com/appnativa/rare/ui/UIColor.h"
#include "com/appnativa/rare/ui/UIDimension.h"
#include "com/appnativa/rare/ui/UIFont.h"
#include "com/appnativa/rare/ui/UIFontHelper.h"
#include "com/appnativa/rare/ui/UIProperties.h"
#include "com/appnativa/rare/ui/iPlatformComponent.h"
#include "com/appnativa/rare/ui/iPlatformGraphics.h"
#include "com/appnativa/rare/ui/iPlatformIcon.h"
#include "com/appnativa/rare/ui/painter/PaintBucket.h"
#include "com/appnativa/rare/ui/painter/iPlatformComponentPainter.h"
#include "com/appnativa/rare/viewer/TableViewer.h"
#include "com/appnativa/rare/viewer/WindowViewer.h"
#include "com/appnativa/rare/viewer/iFormViewer.h"
#include "com/appnativa/rare/widget/LabelWidget.h"
#include "com/appnativa/spot/iSPOTElement.h"
#include "com/appnativa/util/Helper.h"
#include "com/appnativa/util/SNumber.h"
#include "com/appnativa/util/json/JSONArray.h"
#include "com/appnativa/util/json/JSONObject.h"
#include "com/sparseware/bellavista/TrendPanel.h"
#include "java/lang/Float.h"
#include "java/lang/Math.h"
#include "java/lang/StringBuilder.h"
#include "java/util/ArrayList.h"
#include "java/util/Date.h"
#include "java/util/Iterator.h"
#include "java/util/LinkedHashMap.h"
#include "java/util/List.h"
#include "java/util/Map.h"
#include "java/util/Set.h"

@implementation ComSparsewareBellavistaTrendPanel

static id<JavaUtilMap> ComSparsewareBellavistaTrendPanel_trendMap_;
static RARERenderableDataItem * ComSparsewareBellavistaTrendPanel_dateLabel_;
static RARERenderableDataItem * ComSparsewareBellavistaTrendPanel_valueLabel_;
static RARERenderableDataItem * ComSparsewareBellavistaTrendPanel_trendLabel_;
static RARERenderableDataItem * ComSparsewareBellavistaTrendPanel_headerLabel_;
static RAREUIFont * ComSparsewareBellavistaTrendPanel_nameFont_;
static RAREUIFont * ComSparsewareBellavistaTrendPanel_timePeriodFont_;
static int ComSparsewareBellavistaTrendPanel_timePeriodFontHeight_;

+ (id<JavaUtilMap>)trendMap {
  return ComSparsewareBellavistaTrendPanel_trendMap_;
}

+ (void)setTrendMap:(id<JavaUtilMap>)trendMap {
  ComSparsewareBellavistaTrendPanel_trendMap_ = trendMap;
}

+ (RARERenderableDataItem *)dateLabel {
  return ComSparsewareBellavistaTrendPanel_dateLabel_;
}

+ (void)setDateLabel:(RARERenderableDataItem *)dateLabel {
  ComSparsewareBellavistaTrendPanel_dateLabel_ = dateLabel;
}

+ (RARERenderableDataItem *)valueLabel {
  return ComSparsewareBellavistaTrendPanel_valueLabel_;
}

+ (void)setValueLabel:(RARERenderableDataItem *)valueLabel {
  ComSparsewareBellavistaTrendPanel_valueLabel_ = valueLabel;
}

+ (RARERenderableDataItem *)trendLabel {
  return ComSparsewareBellavistaTrendPanel_trendLabel_;
}

+ (void)setTrendLabel:(RARERenderableDataItem *)trendLabel {
  ComSparsewareBellavistaTrendPanel_trendLabel_ = trendLabel;
}

+ (RARERenderableDataItem *)headerLabel {
  return ComSparsewareBellavistaTrendPanel_headerLabel_;
}

+ (void)setHeaderLabel:(RARERenderableDataItem *)headerLabel {
  ComSparsewareBellavistaTrendPanel_headerLabel_ = headerLabel;
}

+ (RAREUIFont *)nameFont {
  return ComSparsewareBellavistaTrendPanel_nameFont_;
}

+ (void)setNameFont:(RAREUIFont *)nameFont {
  ComSparsewareBellavistaTrendPanel_nameFont_ = nameFont;
}

+ (RAREUIFont *)timePeriodFont {
  return ComSparsewareBellavistaTrendPanel_timePeriodFont_;
}

+ (void)setTimePeriodFont:(RAREUIFont *)timePeriodFont {
  ComSparsewareBellavistaTrendPanel_timePeriodFont_ = timePeriodFont;
}

+ (int)timePeriodFontHeight {
  return ComSparsewareBellavistaTrendPanel_timePeriodFontHeight_;
}

+ (int *)timePeriodFontHeightRef {
  return &ComSparsewareBellavistaTrendPanel_timePeriodFontHeight_;
}

- (id)initWithNSString:(NSString *)name
          withNSString:(NSString *)title
   withRAREUTJSONArray:(RAREUTJSONArray *)keys {
  if (self = [super init]) {
    self->title_ = title;
    self->name_ = name;
    if (keys != nil) {
      keyMap_ = [((id<JavaUtilMap>) nil_chk(ComSparsewareBellavistaTrendPanel_trendMap_)) getWithId:title];
      if (keyMap_ == nil) {
        int len = [keys size];
        id<JavaUtilMap> map = [[JavaUtilLinkedHashMap alloc] initWithInt:len];
        for (int i = 0; i < len; i++) {
          RAREUTJSONObject *o = [keys getJSONObjectWithInt:i];
          (void) [map putWithId:[((RAREUTJSONObject *) nil_chk(o)) getStringWithNSString:@"key"] withId:[o getStringWithNSString:@"name"]];
        }
        keyMap_ = map;
        (void) [ComSparsewareBellavistaTrendPanel_trendMap_ putWithId:title withId:map];
      }
    }
  }
  return self;
}

- (BOOL)addTrendWithNSString:(NSString *)key
            withJavaUtilDate:(JavaUtilDate *)date
  withRARERenderableDataItem:(RARERenderableDataItem *)valueItem {
  NSString *name = [((id<JavaUtilMap>) nil_chk(keyMap_)) getWithId:key];
  if (name == nil) {
    return NO;
  }
  if (trends_ == nil) {
    trends_ = [[JavaUtilLinkedHashMap alloc] init];
  }
  ComSparsewareBellavistaTrendPanel_Trend *t = [((id<JavaUtilMap>) nil_chk(trends_)) getWithId:key];
  if (t == nil) {
    t = [[ComSparsewareBellavistaTrendPanel_Trend alloc] initWithNSString:name];
    (void) [trends_ putWithId:key withId:t];
  }
  [((ComSparsewareBellavistaTrendPanel_Trend *) nil_chk(t)) addWithJavaUtilDate:date withNSString:[((RARERenderableDataItem *) nil_chk(valueItem)) description] withRAREUIColor:[valueItem getForeground]];
  return YES;
}

- (BOOL)addTrendWithNSString:(NSString *)key
            withJavaUtilDate:(JavaUtilDate *)date
                withNSString:(NSString *)name
  withRARERenderableDataItem:(RARERenderableDataItem *)valueItem {
  if (trends_ == nil) {
    trends_ = [[JavaUtilLinkedHashMap alloc] init];
  }
  ComSparsewareBellavistaTrendPanel_Trend *t = [((id<JavaUtilMap>) nil_chk(trends_)) getWithId:key];
  if (t == nil) {
    t = [[ComSparsewareBellavistaTrendPanel_Trend alloc] initWithNSString:name];
    (void) [trends_ putWithId:key withId:t];
  }
  [((ComSparsewareBellavistaTrendPanel_Trend *) nil_chk(t)) addWithJavaUtilDate:date withNSString:[((RARERenderableDataItem *) nil_chk(valueItem)) description] withRAREUIColor:[valueItem getForeground]];
  return YES;
}

- (void)clear {
  if (trends_ != nil) {
    [trends_ clear];
  }
}

- (void)popuplateTableWithRARETableViewer:(RARETableViewer *)table
                          withJavaUtilMap:(id<JavaUtilMap>)layout {
  int colCount = [((RARETableViewer *) nil_chk(table)) getColumnCount];
  RAREWindowViewer *w = [RAREPlatform getWindowViewer];
  RARELabelWidget *label = [RAREaLabelWidget createWithRAREiContainer:[table getFormViewer] withRARESPOTLabel:(RARESPOTLabel *) check_class_cast([((RAREWindowViewer *) nil_chk(w)) createConfigurationObjectWithNSString:@"Label" withNSString:@"bv.label.trendPanelHeader"], [RARESPOTLabel class])];
  [((RARELabelWidget *) nil_chk(label)) setValueWithId:title_];
  RARERenderableDataItem *header = [table createRowWithInt:colCount withBoolean:YES];
  [((RARERenderableDataItem *) nil_chk(header)) setHeightWithInt:[((RAREUIDimension *) nil_chk([label getPreferredSize])) intHeight]];
  RARERenderableDataItem *item = [header getWithInt:0];
  RARERenderableDataItem *col;
  [((RARERenderableDataItem *) nil_chk(item)) setRenderingComponentWithRAREiPlatformComponent:[label getContainerComponent]];
  [item setColumnSpanWithInt:colCount];
  [table addExWithRARERenderableDataItem:header];
  BOOL singleColumn = [table getColumnCount] == 1;
  if (trends_ == nil || [trends_ isEmpty]) {
    header = [table createRowWithInt:colCount withBoolean:YES];
    col = [((RARERenderableDataItem *) nil_chk(header)) getWithInt:0];
    [((RARERenderableDataItem *) nil_chk(col)) setColumnSpanWithInt:colCount];
    item = [[RARERenderableDataItem alloc] initWithId:[w getStringWithNSString:@"bv.text.no_lab_trends"]];
    [item setEnabledWithBoolean:NO];
    [item setHorizontalAlignmentWithRARERenderableDataItem_HorizontalAlignEnum:[RARERenderableDataItem_HorizontalAlignEnum CENTER]];
    (void) [col setCustomPropertyWithId:[((id<JavaUtilMap>) nil_chk(layout)) getWithId:@"name"] withId:item];
    [table addExWithRARERenderableDataItem:header];
    return;
  }
  int count = (int) [JavaLangMath floorWithDouble:([((id<JavaUtilMap>) nil_chk(trends_)) size] + 1) / colCount];
  id<JavaUtilList> list = [[JavaUtilArrayList alloc] initWithInt:count];
  for (int i = 0; i < count; i++) {
    [list addWithId:[table createRowWithInt:colCount withBoolean:YES]];
  }
  id<JavaUtilIterator> it;
  if (keyMap_ == nil) {
    it = [((id<JavaUtilSet>) nil_chk([trends_ keySet])) iterator];
  }
  else {
    it = [((id<JavaUtilSet>) nil_chk([keyMap_ keySet])) iterator];
  }
  RARERenderableDataItem *row = nil;
  int n = 0;
  int i = 0;
  RAREPaintBucket *pb = [((RAREUIProperties *) nil_chk([RAREPlatform getUIDefaults])) getPaintBucketWithNSString:@"TrendPanel.labName"];
  id<RAREiPlatformComponentPainter> cp = pb == nil ? nil : [pb getCachedComponentPainter];
  RAREUIFont *font = ComSparsewareBellavistaTrendPanel_nameFont_;
  ;
  if (pb != nil && [pb getFont] != nil) {
    font = [pb getFont];
  }
  id ctx = [((RAREColumn *) nil_chk([table getColumnWithInt:0])) getValueContext];
  while ([((id<JavaUtilIterator>) nil_chk(it)) hasNext]) {
    ComSparsewareBellavistaTrendPanel_Trend *t = [trends_ getWithId:[it next]];
    if (t == nil) {
      continue;
    }
    if (n == 0) {
      row = [list getWithInt:i++];
    }
    col = [((RARERenderableDataItem *) nil_chk(row)) getWithInt:n];
    [row setLinkedDataWithId:t];
    item = [[RARERenderableDataItem alloc] initWithId:((ComSparsewareBellavistaTrendPanel_Trend *) nil_chk(t))->name_];
    [item setFontWithRAREUIFont:font];
    [item setComponentPainterWithRAREiPlatformComponentPainter:cp];
    (void) [((RARERenderableDataItem *) nil_chk(col)) setCustomPropertyWithId:[((id<JavaUtilMap>) nil_chk(layout)) getWithId:@"name"] withId:item];
    item = [[RARERenderableDataItem alloc] initWithId:t->value_];
    if (IOSObjectArray_Get(nil_chk(t->colors_), 3) != nil) {
      [item setForegroundWithRAREUIColor:IOSObjectArray_Get(t->colors_, 3)];
    }
    (void) [col setCustomPropertyWithId:[layout getWithId:@"valueValue"] withId:item];
    item = [[RARERenderableDataItem alloc] initWithId:t->date_ withInt:RARERenderableDataItem_TYPE_DATETIME withId:nil];
    [item setValueContextWithId:ctx];
    (void) [col setCustomPropertyWithId:[layout getWithId:@"dateValue"] withId:item];
    item = [[RARERenderableDataItem alloc] initWithNSString:@"" withId:nil withRAREiPlatformIcon:t];
    (void) [col setCustomPropertyWithId:[layout getWithId:@"trendIcon"] withId:item];
    (void) [col setCustomPropertyWithId:[layout getWithId:@"date"] withId:ComSparsewareBellavistaTrendPanel_dateLabel_];
    (void) [col setCustomPropertyWithId:[layout getWithId:@"value"] withId:ComSparsewareBellavistaTrendPanel_valueLabel_];
    if (!singleColumn) {
      n = 1 - n;
    }
  }
  for (i = 0; i < count; i++) {
    row = [list getWithInt:i];
    if ([((RARERenderableDataItem *) nil_chk(row)) getLinkedData] != nil) {
      [row setLinkedDataWithId:nil];
      [table addExWithRARERenderableDataItem:row];
    }
  }
}

+ (void)setupLabelsWithRAREWindowViewer:(RAREWindowViewer *)w {
  [((RARERenderableDataItem *) nil_chk(ComSparsewareBellavistaTrendPanel_dateLabel_)) setValueWithId:[NSString stringWithFormat:@"%@:", [((RAREWindowViewer *) nil_chk(w)) getStringWithNSString:@"bv.text.date"]]];
  [((RARERenderableDataItem *) nil_chk(ComSparsewareBellavistaTrendPanel_valueLabel_)) setValueWithId:[NSString stringWithFormat:@"%@:", [w getStringWithNSString:@"bv.text.value"]]];
  [((RARERenderableDataItem *) nil_chk(ComSparsewareBellavistaTrendPanel_trendLabel_)) setValueWithId:[NSString stringWithFormat:@"%@:", [w getStringWithNSString:@"bv.text.trend"]]];
  [ComSparsewareBellavistaTrendPanel_dateLabel_ setHorizontalAlignmentWithRARERenderableDataItem_HorizontalAlignEnum:[RARERenderableDataItem_HorizontalAlignEnum RIGHT]];
  [ComSparsewareBellavistaTrendPanel_valueLabel_ setHorizontalAlignmentWithRARERenderableDataItem_HorizontalAlignEnum:[RARERenderableDataItem_HorizontalAlignEnum RIGHT]];
  [ComSparsewareBellavistaTrendPanel_trendLabel_ setHorizontalAlignmentWithRARERenderableDataItem_HorizontalAlignEnum:[RARERenderableDataItem_HorizontalAlignEnum RIGHT]];
  ComSparsewareBellavistaTrendPanel_nameFont_ = [((RAREUIFont *) nil_chk([RAREFontUtils getDefaultFont])) deriveBold];
  ComSparsewareBellavistaTrendPanel_timePeriodFont_ = [((RAREUIFont *) nil_chk([RAREFontUtils getDefaultFont])) deriveFontSizeWithFloat:[((RAREUIFont *) nil_chk([RAREFontUtils getDefaultFont])) getSize] - 4];
  ComSparsewareBellavistaTrendPanel_timePeriodFontHeight_ = (int) [RAREFontUtils getFontHeightWithRAREUIFont:ComSparsewareBellavistaTrendPanel_timePeriodFont_ withBoolean:NO] - [RAREScreenUtils PLATFORM_PIXELS_4];
  RAREUIColor *color = [RAREColorUtils getColorWithNSString:@"clinicalPrompt"];
  [ComSparsewareBellavistaTrendPanel_dateLabel_ setForegroundWithRAREUIColor:color];
  [ComSparsewareBellavistaTrendPanel_trendLabel_ setForegroundWithRAREUIColor:color];
  [ComSparsewareBellavistaTrendPanel_valueLabel_ setForegroundWithRAREUIColor:color];
  RAREUIFont *font = [RAREFontUtils getDefaultFont];
  font = [font deriveFontSizeWithFloat:[((RAREUIFont *) nil_chk(font)) getSize] - 1];
  [ComSparsewareBellavistaTrendPanel_dateLabel_ setFontWithRAREUIFont:font];
  [ComSparsewareBellavistaTrendPanel_valueLabel_ setFontWithRAREUIFont:font];
  [ComSparsewareBellavistaTrendPanel_trendLabel_ setFontWithRAREUIFont:font];
}

+ (void)initialize {
  if (self == [ComSparsewareBellavistaTrendPanel class]) {
    ComSparsewareBellavistaTrendPanel_trendMap_ = [[JavaUtilLinkedHashMap alloc] initWithInt:4];
    ComSparsewareBellavistaTrendPanel_dateLabel_ = [[RARERenderableDataItem alloc] init];
    ComSparsewareBellavistaTrendPanel_valueLabel_ = [[RARERenderableDataItem alloc] init];
    ComSparsewareBellavistaTrendPanel_trendLabel_ = [[RARERenderableDataItem alloc] init];
    ComSparsewareBellavistaTrendPanel_headerLabel_ = [[RARERenderableDataItem alloc] init];
  }
}

- (void)copyAllFieldsTo:(ComSparsewareBellavistaTrendPanel *)other {
  [super copyAllFieldsTo:other];
  other->keyMap_ = keyMap_;
  other->name_ = name_;
  other->title_ = title_;
  other->trends_ = trends_;
}

+ (J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { "addTrendWithNSString:withJavaUtilDate:withRARERenderableDataItem:", NULL, "Z", 0x1, NULL },
    { "addTrendWithNSString:withJavaUtilDate:withNSString:withRARERenderableDataItem:", NULL, "Z", 0x1, NULL },
  };
  static J2ObjcFieldInfo fields[] = {
    { "trendMap_", NULL, 0x8, "LJavaUtilMap" },
    { "name_", NULL, 0x0, "LNSString" },
    { "title_", NULL, 0x0, "LNSString" },
    { "keyMap_", NULL, 0x0, "LJavaUtilMap" },
    { "trends_", NULL, 0x0, "LJavaUtilMap" },
    { "dateLabel_", NULL, 0x8, "LRARERenderableDataItem" },
    { "valueLabel_", NULL, 0x8, "LRARERenderableDataItem" },
    { "trendLabel_", NULL, 0x8, "LRARERenderableDataItem" },
    { "headerLabel_", NULL, 0x8, "LRARERenderableDataItem" },
    { "nameFont_", NULL, 0x8, "LRAREUIFont" },
    { "timePeriodFont_", NULL, 0x8, "LRAREUIFont" },
    { "timePeriodFontHeight_", NULL, 0x8, "I" },
  };
  static J2ObjcClassInfo _ComSparsewareBellavistaTrendPanel = { "TrendPanel", "com.sparseware.bellavista", NULL, 0x1, 2, methods, 12, fields, 0, NULL};
  return &_ComSparsewareBellavistaTrendPanel;
}

@end
@implementation ComSparsewareBellavistaTrendPanel_Trend

- (id)initWithNSString:(NSString *)name {
  if (self = [super init]) {
    numbers_ = [IOSFloatArray arrayWithLength:4];
    colors_ = [IOSObjectArray arrayWithLength:4 type:[IOSClass classWithClass:[RAREUIColor class]]];
    index_ = 4;
    segmentLength_ = [RAREScreenUtils PLATFORM_PIXELS_8];
    startingY_ = -1;
    drawTimePeriod_ = YES;
    self->name_ = name;
  }
  return self;
}

- (void)addWithJavaUtilDate:(JavaUtilDate *)date
               withNSString:(NSString *)value
            withRAREUIColor:(RAREUIColor *)color {
  if (index_ > 0) {
    if (self->date_ == nil) {
      self->date_ = date;
      self->value_ = value;
    }
    startDate_ = date;
    (*IOSFloatArray_GetRef(nil_chk(numbers_), --index_)) = [((RAREUTSNumber *) [[RAREUTSNumber alloc] initWithNSString:value withBoolean:NO]) floatValue];
    (void) IOSObjectArray_Set(nil_chk(colors_), index_, color);
  }
}

- (void)calculateStartingYPositionm {
  int total = [self getIconHeight] - (segmentLength_ * 2);
  int max = total;
  int y = total;
  int min = total;
  float lv = JavaLangFloat_NaN;
  for (int i = 0; i < 4; i++) {
    float num = IOSFloatArray_Get(nil_chk(numbers_), i);
    if ([JavaLangFloat isNaNWithFloat:lv]) {
      if (![RAREUTSNumber isEqualWithFloat:lv withFloat:num]) {
        if (num > lv) {
          y -= segmentLength_;
        }
        else {
          y += segmentLength_;
        }
      }
      min = [JavaLangMath minWithInt:y withInt:min];
      max = [JavaLangMath maxWithInt:y withInt:max];
    }
    lv = num;
  }
  int height = max - min;
  startingY_ = max - height - [RAREScreenUtils PLATFORM_PIXELS_4];
}

- (id<RAREiPlatformIcon>)getDisabledVersion {
  return self;
}

- (int)getIconHeight {
  return (segmentLength_ * 6) + (drawTimePeriod_ ? [ComSparsewareBellavistaTrendPanel timePeriodFontHeight] : 0);
}

- (int)getIconWidth {
  if (drawTimePeriod_) {
    if (timePeroid_ == nil) {
      [self calculateTimeperiod];
    }
  }
  return (int) [JavaLangMath maxWithFloat:segmentLength_ * 6 withFloat:timePeriodWidth_ + [RAREScreenUtils PLATFORM_PIXELS_4]];
}

- (void)paintWithRAREiPlatformGraphics:(id<RAREiPlatformGraphics>)g
                             withFloat:(float)x
                             withFloat:(float)y
                             withFloat:(float)width
                             withFloat:(float)height {
  if (startingY_ == -1) {
    [self calculateStartingYPositionm];
  }
  int iw = [self getIconWidth];
  int ih = [self getIconHeight];
  y += (height - ih) / 2;
  width = iw;
  height = ih;
  float d1 = [RAREScreenUtils PLATFORM_PIXELS_1];
  float d2 = [RAREScreenUtils PLATFORM_PIXELS_2];
  y += [RAREScreenUtils PLATFORM_PIXELS_4];
  height -= [RAREScreenUtils PLATFORM_PIXELS_4];
  float sy = startingY_ + y;
  float ny = sy;
  float sx = x + [RAREScreenUtils PLATFORM_PIXELS_4];
  float lv = JavaLangFloat_NaN;
  RAREUIColor *oc = [((id<RAREiPlatformGraphics>) nil_chk(g)) getColor];
  float sw = [g getStrokeWidth];
  [g setStrokeWidthWithFloat:d1];
  [g setPaintWithRAREiPlatformPaint:[RAREColorUtils getColorWithNSString:@"trendBackground"]];
  [g fillRectWithFloat:x withFloat:y withFloat:width withFloat:height];
  [g setColorWithRAREUIColor:[RAREColorUtils getControlShadow]];
  [g drawRectWithFloat:x withFloat:y withFloat:width withFloat:height];
  if (drawTimePeriod_) {
    if (timePeroid_ == nil) {
      [self calculateTimeperiod];
    }
    [g setFontWithRAREUIFont:[ComSparsewareBellavistaTrendPanel timePeriodFont]];
    [g drawStringWithNSString:timePeroid_ withFloat:x + ((width - timePeriodWidth_) / 2) withFloat:y + [RAREScreenUtils PLATFORM_PIXELS_2] withFloat:[ComSparsewareBellavistaTrendPanel timePeriodFontHeight]];
  }
  [g setStrokeWidthWithFloat:d2];
  sy += (drawTimePeriod_ ? [ComSparsewareBellavistaTrendPanel timePeriodFontHeight] : 0);
  RAREUIColor *c;
  for (int i = 0; i < 4; i++) {
    float num = IOSFloatArray_Get(nil_chk(numbers_), i);
    if (![JavaLangFloat isNaNWithFloat:lv]) {
      if (![RAREUTSNumber isEqualWithFloat:lv withFloat:num]) {
        if (num > lv) {
          ny = sy - segmentLength_;
        }
        else {
          ny = sy + segmentLength_;
        }
      }
    }
    c = IOSObjectArray_Get(nil_chk(colors_), i);
    [g setColorWithRAREUIColor:c == nil ? [RAREUIColor GRAY] : c];
    lv = num;
    [g drawLineWithFloat:sx withFloat:sy withFloat:sx + segmentLength_ withFloat:ny];
    [g setColorWithRAREUIColor:[RAREUIColor BLACK]];
    [g drawRoundRectWithFloat:sx - d1 withFloat:sy - d1 withFloat:d2 withFloat:d2 withFloat:d2 withFloat:d2];
    sy = ny;
    sx += segmentLength_;
  }
  [g setColorWithRAREUIColor:[RAREUIColor BLACK]];
  [g drawRoundRectWithFloat:sx withFloat:sy - d1 withFloat:d2 withFloat:d2 withFloat:d2 withFloat:d2];
  [g setColorWithRAREUIColor:oc];
  [g setStrokeWidthWithFloat:sw];
}

- (void)calculateTimeperiod {
  int days = [JavaLangMath absWithInt:[RAREUTHelper daysBetweenWithJavaUtilDate:startDate_ withJavaUtilDate:date_]];
  if (days < 1) {
    days = 1;
  }
  RAREUTSNumber *num = [[RAREUTSNumber alloc] init];
  NSString *suf;
  if (days > 365) {
    (void) [num setValueWithDouble:(float) (days / 365)];
    (void) [num setScaleWithInt:1];
    suf = @"year";
  }
  else if (days > 29) {
    (void) [num setValueWithDouble:(float) (days / 30)];
    (void) [num setScaleWithInt:1];
    suf = @"month";
  }
  else {
    (void) [num setValueWithInt:days];
    (void) [num setScaleWithInt:1];
    suf = @"day";
  }
  JavaLangStringBuilder *sb = [[JavaLangStringBuilder alloc] init];
  (void) [sb appendWithNSString:suf];
  if ([num gtWithInt:1]) {
    (void) [sb appendWithNSString:@"s"];
  }
  suf = [RAREPlatform getResourceAsStringWithNSString:[NSString stringWithFormat:@"bv.text.time_trend.%@", [sb description]]];
  [sb setLengthWithInt:0];
  (void) [((JavaLangStringBuilder *) nil_chk([sb appendWithId:num])) appendWithNSString:suf];
  timePeroid_ = [sb description];
  timePeriodWidth_ = [RAREUIFontHelper stringWidthWithRAREUIFont:[ComSparsewareBellavistaTrendPanel timePeriodFont] withNSString:timePeroid_];
}

- (BOOL)isDrawTimePeriod {
  return drawTimePeriod_;
}

- (void)setDrawTimePeriodWithBoolean:(BOOL)drawTimePeriod {
  self->drawTimePeriod_ = drawTimePeriod;
}

- (void)copyAllFieldsTo:(ComSparsewareBellavistaTrendPanel_Trend *)other {
  [super copyAllFieldsTo:other];
  other->colors_ = colors_;
  other->date_ = date_;
  other->drawTimePeriod_ = drawTimePeriod_;
  other->index_ = index_;
  other->name_ = name_;
  other->numbers_ = numbers_;
  other->segmentLength_ = segmentLength_;
  other->startDate_ = startDate_;
  other->startingY_ = startingY_;
  other->timePeriodWidth_ = timePeriodWidth_;
  other->timePeroid_ = timePeroid_;
  other->value_ = value_;
}

+ (J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { "addWithJavaUtilDate:withNSString:withRAREUIColor:", NULL, "V", 0x0, NULL },
    { "calculateStartingYPositionm", NULL, "V", 0x0, NULL },
    { "getDisabledVersion", NULL, "LRAREiPlatformIcon", 0x1, NULL },
    { "calculateTimeperiod", NULL, "V", 0x0, NULL },
    { "isDrawTimePeriod", NULL, "Z", 0x0, NULL },
    { "setDrawTimePeriodWithBoolean:", NULL, "V", 0x0, NULL },
  };
  static J2ObjcFieldInfo fields[] = {
    { "numbers_", NULL, 0x0, "LIOSFloatArray" },
    { "colors_", NULL, 0x0, "LIOSObjectArray" },
    { "index_", NULL, 0x0, "I" },
    { "name_", NULL, 0x0, "LNSString" },
    { "date_", NULL, 0x0, "LJavaUtilDate" },
    { "startDate_", NULL, 0x0, "LJavaUtilDate" },
    { "value_", NULL, 0x0, "LNSString" },
    { "segmentLength_", NULL, 0x0, "I" },
    { "startingY_", NULL, 0x0, "I" },
    { "timePeroid_", NULL, 0x0, "LNSString" },
  };
  static J2ObjcClassInfo _ComSparsewareBellavistaTrendPanel_Trend = { "Trend", "com.sparseware.bellavista", "TrendPanel", 0x9, 6, methods, 10, fields, 0, NULL};
  return &_ComSparsewareBellavistaTrendPanel_Trend;
}

@end
